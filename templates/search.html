{% extends "layout.html" %}


{% block content %}

  <div class="row">
    <h1>Hambar109 – căutare în documente publice</h1>
  </div>

  {% set query = request.args.get('q', '') %}

  <div class="pd-search">
    <form>
      <input type="search" placeholder="... text ..."
             name="q" value="{{ query }}">
      <button type="submit">caută</button>
    </form>
  </div>

  {% if results %}
  <div class="row">
    <div class="span12">

      <p>{{ results['hits']['total'] }} hits</p>

      <ul class="pd-search-results">
      {% for hit in results['hits']['hits'] %}
        <li>

          {% set code = hit['_id'] %}
          {% set text_url = url_for('.document_text', document_code=code) %}
          <h4><a href="{{ text_url }}">{{ code }}</a></h4>

          {% if 'highlight' in hit %}
            <p>{{ hit['highlight']['content']|format_highlight }}</p>
          {% endif %}

        </li>
      {% endfor %}
      </ul>

      <p class="pd-navigation">
        <a href="{{ next_url|safe }}">next</a>
      </p>

    </div>
  </div>
  {% endif %}

  {% if not query %}
  <div class="row">

    <p class="span12">
      Baza de date conține edițiile Monitorul Oficial publicate până în
      decembrie 2011, toate părțile (1 până la 7).  Exemple de căutare:
    </p>

    <ul class="span12">

      <li>
        După cuvinte din text:
        <code><a href="/?q=achiziții+publice">achiziții
        publice</a></code>.
      </li>

      <li>
        După cuvinte alăturate:
        <code><a href="/?q=&quot;achiziții+publice&quot;">"achiziții
        publice"</a></code>.
      </li>

      <li>
        Eliminarea unui cuvânt (achiziții care nu sunt publice):
        <code><a href="/?q=achiziții+-publice">achiziții
        -publice</a></code>.
      </li>

    </ul>

  </div>
  {% endif %}

{% endblock %}
